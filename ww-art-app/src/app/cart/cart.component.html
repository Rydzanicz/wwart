<div class="cart-container">

  <div class="cart-header">
    <div class="breadcrumb">
      <a routerLink="/shop">Sklep</a> / <span>Koszyk</span>
    </div>
    <h3 >
      <span class="cart-icon">üõí</span>
      Tw√≥j koszyk
    </h3>
    <p class="cart-count" *ngIf="cartItems.length > 0">
      {{ cartItems.length }} {{ cartItems.length === 1 ? 'produkt' : 'produkt√≥w' }} w koszyku
    </p>
  </div>
  <div class="info-banner test-mode-banner">
    <span class="banner-icon">‚ö†Ô∏è</span>
    To jest wersja testowa sklepu ‚Äì sprzeda≈º produkt√≥w nie jest jeszcze aktywna.
  </div>

  <div class="cart-content" *ngIf="cartItems.length > 0">
    <div class="cart-items">
      <div *ngFor="let item of cartItems; trackBy: trackByCartItem" class="cart-item">
        <div class="item-image">
          <img
            [src]="item.image"
            [alt]="item.name"
            (error)="onImageError($event)"
            class="product-img">
        </div>
        <div class="item-details">
          <h3 class="item-name">{{ item.name }}</h3>
          <div class="item-category" *ngIf="item.category">
            {{ item.category }}
          </div>
          <div class="item-options">
            <div class="option-tag" *ngIf="item.size">
              <span class="option-label">Rozmiar:</span>
              <span class="option-value">{{ item.size }}</span>
            </div>

            <div class="option-tag" *ngIf="item.color">
              <span class="option-label">Kolor:</span>
              <span class="option-value">{{ item.color }}</span>
            </div>
          </div>
        </div>

        <div class="item-controls">
          <div class="item-price">
            {{ item.price }} PLN
            <div class="price-per-unit" *ngIf="item.quantity > 1">
              {{ item.quantity }} √ó {{ item.price }} PLN
            </div>
          </div>

          <div class="quantity-section">
            <div class="quantity-controls">
              <button
                (click)="decreaseQuantity(item)"
                [disabled]="item.quantity <= 1"
                class="qty-btn">
                ‚àí
              </button>
              <span class="quantity-display">{{ item.quantity }}</span>
              <button
                (click)="increaseQuantity(item)"
                class="qty-btn">
                +
              </button>
            </div>
          </div>

          <div class="item-total">
            {{ getItemTotal(item) }} PLN
          </div>

          <button
            (click)="removeItem(item)"
            class="remove-btn"
            title="Usu≈Ñ produkt">
            üóëÔ∏è
          </button>
        </div>
      </div>
    </div>

    <div class="cart-summary">
      <h2 class="summary-title">Podsumowanie zam√≥wienia</h2>

      <div class="summary-line">
        <span>Warto≈õƒá produkt√≥w:</span>
        <span class="summary-value">{{ getSubtotal() }} PLN</span>
      </div>

      <div class="summary-line" *ngIf="shipping > 0">
        <span>Dostawa:</span>
        <span class="summary-value">{{ shipping }} PLN</span>
      </div>

      <div class="summary-line free-shipping" *ngIf="shipping === 0">
        <span>Dostawa:</span>
        <span class="summary-value free">GRATIS</span>
      </div>

      <div class="summary-line" *ngIf="discount > 0">
        <span>Rabat:</span>
        <span class="summary-value discount">-{{ discount }} PLN</span>
      </div>

      <div class="summary-line total">
        <span>Razem do zap≈Çaty:</span>
        <span class="summary-value">{{ getTotalPrice() }} PLN</span>
      </div>

      <div class="order-notes">
        <label for="orderNote" class="note-label">Uwagi do zam√≥wienia:</label>
        <textarea
          id="orderNote"
          [(ngModel)]="orderNote"
          class="note-input"
          placeholder="Dodatkowe informacje o zam√≥wieniu..."
          rows="3">
        </textarea>
      </div>

      <div class="action-buttons">
        <button
          (click)="clearCart()"
          class="clear-btn"
          *ngIf="cartItems.length > 0">
          Wyczy≈õƒá koszyk
        </button>

        <button
          (click)="proceedToCheckout()"
          [disabled]="isProcessing"
          class="checkout-btn">
          <span *ngIf="!isProcessing">
            Przejd≈∫ do p≈Çatno≈õci
            <span class="checkout-icon">üõçÔ∏è</span>
          </span>
          <span *ngIf="isProcessing">Przetwarzanie...</span>
        </button>
      </div>
    </div>
  </div>

  <div class="empty-cart" *ngIf="cartItems.length === 0">
    <div class="empty-cart-icon">üõí</div>
    <h4>Tw√≥j koszyk jest pusty</h4>
    <p>Dodaj produkty do koszyka, aby kontynuowaƒá zakupy</p>
    <button routerLink="/shop" class="shop-btn">
      <span class="shop-icon">üè™</span>
      Przejd≈∫ do sklepu
    </button>
  </div>
</div>
